<HTML>
<HEAD>
<title>Разработка Smart Tags в виде ActiveX DLL
</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<meta name="robots" content="index, follow" />
<meta name="keywords" content="Андрей Колесов Для чтения этой статьи желательны некоторые познания в разработке COM-объектов и языке Visual Basic. Полный вариант рассмотренного здесь программного проекта (файл AndyTest.ZIP, 16 Кбайт) можно найти на сайте" />
<meta name="description" content="Андрей Колесов Для чтения этой статьи желательны некоторые познания в разработке COM-объектов и языке Visual Basic. Полный вариант рассмотренного здесь программного проекта (файл AndyTest.ZIP, 16 Кбайт) можно найти на сайте" />
<link href="../bitrix/js/main/core/css/core.css@1397654732.css" type="text/css" rel="stylesheet" />
<link href="../bitrix/templates/main/styles.css@1357814843.css" type="text/css" rel="stylesheet" />
<link href="../bitrix/templates/main/template_styles.css@1357814843.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="../bitrix/js/main/core/core.js@1397654768"></script>
<script type="text/javascript">BX.message({'LANGUAGE_ID':'ru','FORMAT_DATE':'DD.MM.YYYY','FORMAT_DATETIME':'DD.MM.YYYY HH:MI:SS','COOKIE_PREFIX':'BITRIX_SM','USER_ID':'','SERVER_TIME':'1398077716','SERVER_TZ_OFFSET':'14400','USER_TZ_OFFSET':'0','bitrix_sessid':'b8a7a6a0086bde8dc8bdb2b592b7e6d2','SITE_ID':'ru','JS_CORE_LOADING':'Загрузка...','JS_CORE_WINDOW_CLOSE':'Закрыть','JS_CORE_WINDOW_EXPAND':'Развернуть','JS_CORE_WINDOW_NARROW':'Свернуть в окно','JS_CORE_WINDOW_SAVE':'Сохранить','JS_CORE_WINDOW_CANCEL':'Отменить','JS_CORE_H':'ч','JS_CORE_M':'м','JS_CORE_S':'с'})</script>
<script type="text/javascript" src="../bitrix/js/main/core/core_ajax.js@1397654452"></script>
<script type="text/javascript" src="../bitrix/js/main/session.js@1314803764"></script>
<script type="text/javascript">
bxSession.Expand(10800, 'b8a7a6a0086bde8dc8bdb2b592b7e6d2', false, '2688bad5c95a57f544635a13a7ff0826');
</script>
<META http-equiv="Refresh" CONTENT="3600">
<LINK REL='alternate' TITLE='BYTE/Россия: Новые статьи на сайте' HREF='../rss/index.php' TYPE='application/rss+xml'>
<link rel="stylesheet" href="../images/byte/css/main.css" type="text/css">
<link rel="stylesheet" href="../images/sk/css/menu.css" type="text/css">
<link rel="icon" href="../favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
<script language="JavaScript" src="../bitrix/templates/main/jquery.js"></script>
<script language="JavaScript" src="../bitrix/templates/main/main.js"></script>
<meta name='yandex-verification' content='4637394ebf6b856d' />
<meta name="google-site-verification" content="YuDDKJUKYlersC5RZAAO_epNdELhEXLrgxUxtn4_31Q" />
</HEAD>
<BODY>


<DIV id="container">

<center>
<table id="skmenu">
<tr>
<td class="cl"><img src="../images/sk/lc.gif"></td>
<!--<td class="bgr"><a href="http://www.skpress.ru" title="СК Пресс" target="_blank">СК Пресс:</a></td>-->
<td class="bgr"><a href="http://www.itrn.ru" title="Современные информационные технологии" target="_blank">ITRN:</a></td>
<td class="del"><img src="../images/sk/cc.gif"></td>
<td class="bglg"><a href="http://www.itbestsellers.ru" title="Бестселлеры IT-рынка">Бестселлеры IT-рынка</a></td>
<td class="del"><img src="../images/sk/del.gif"></td>
<td class="bgdg">BYTE/Россия</td>
<td class="del"><img src="../images/sk/del.gif"></td>
<td class="bglg"><a href="http://www.crn.ru" title="CRN/RE">CRN/RE</a></td>
<td class="del"><img src="../images/sk/del.gif"></td>
<td class="bglg"><a href="http://www.iemag.ru" title="Intelligent Enterprise/RE">Intelligent Enterprise/RE</a></td>
<td class="del"><img src="../images/sk/del.gif"></td>
<td class="bglg"><a href="http://www.pcmag.ru" title="PC Magazine/RE">PC Magazine/RE</a></td>
<td class="del"><img src="../images/sk/del.gif"></td>
<td class="bglg"><a href="http://www.pcweek.ru" title="PC Week/RE">PC Week/RE</a></td>
<td class="cl"><img src="../images/sk/rc.gif"></td>
</tr>
</table>
</center>

<TABLE border="0" cellpadding="0" cellspacing="0" width="1000">
<TR>
<TD class='top-banner' colspan='3'>

<script language="JavaScript">
<!--
var banner_random = Math.round(Math.random() * 100000);
document.write('<iframe name="byte_top_adv" id="byte_top_adv" src="/ad/banners/top.php?banner_random='+banner_random+'" width="100%" height="90" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>');
// -->
</script>
<noscript>
<iframe name="byte_top_adv" id="byte_top_adv" src="../ad/banners/top.php.html" width="100%" height="90" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>
</noscript>
</TD>
</TR>
<TR>
<TD class='top-menu-g'><a href='index.php@TYPE_ID=6260.html'>Новости</a><a href='../numbers/index.html'>Архив</a><a href='../foto/index.html'>Фоторепортажи</a><a href='../video/index.html'>Видеоролики</a><a href='../events/index.html'>Мероприятия</a><a href='../forum/index.html'>Форумы</a><a href='../white-papers/index.html'>Решения</a><a href='../courses/index.html'>Учебные курсы</a><a href='../subscribe/index.html'>Подписка на рассылки</a><a href='../about/index.html'>Об издании</a></TD>
<TD valign='top' class='top-menu-d'><img src="../images/byte/top-menu-delim.gif"></TD>
<TD class='top-menu-r'><a href='../auth/index.html'>Авторизация</a></TD>
</TR>
</TABLE>
<!-- для баннера топгир
<map name="map1"> <area href="/articles/index.php?TYPE_ID=6254" alt="Сети и телекоммуникации" shape="rect" coords="0,0,177,18"></area> <area href="http://netgear.ru/?page=products" alt="netgear" shape="rect" coords="0,18,177,36"></area> </map>-->

<TABLE border="0" cellpadding="0" cellspacing="0" width="1000">
<TR>
<TD><a href='../index.html' title='На главную'><!--<img src="/images/newlogo.gif" class='logo'>--><img src="../images/byte/logo.gif" class='logo'></a></TD>
<TD valign='top' width="90%">

	<table border="0" cellpadding="0" cellspacing="0" width="100%">
	<tr>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6250.html'>Технопарк</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6251.html'>Клуб экспертов</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6252.html'>Платформы и технологии</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6253.html'>Проекты</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><!--<img src="/images/netgear.gif" usemap="#map1" border="0">--><a href='index.php@TYPE_ID=6254.html'>Сети и телекоммуникации</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=16029.html'>Обзоры</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6256.html'>Средства разработки</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	</tr>
	</table>
	<table border="0" cellpadding="0" cellspacing="0" width="100%">
	<tr>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6257.html'>Программное обеспечение</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6258.html'>Безопасность</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>
	<td class='rubric-c-l'><img src="../images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='index.php@TYPE_ID=6255.html'>ByteLab</a></td>
	<td class='rubric-c-r'><img src="../images/byte/c-r.gif"></td>

	<!--<td class='rubric-c-l'><img src="/images/byte/c-l.gif"></td>
	<td class='rubric' nowrap><a href='/articles/index.php?TYPE_ID=6259'>Колонка редактора</a></td>-->
	<td class='rubric-c-r-r'><img src="../images/byte/c-r-r.gif"></td>
	<td class='rubric-r' nowrap><!--<a href='/blog/'>--><a>Блоги</a><!--</a>--></td>
	<td><img src="../images/byte/rubric-delim-l.gif" class='rubric-delim'></td>
	<td class='search-block'><img src="../images/byte/search-title.gif" class='search-title' alt='Поиск'></td>
	<td class='search-block' width='40%'><FORM action="http://www.bytemag.ru/search/index.php" method="GET" name="FormSearch"><input type="hidden" name="how" value="d"><input id="queryText" name="q" size='20' style='width: 100%;'></td>
	<td class='search-block'><input type='image' src='../images/byte/btn-search.gif'></FORM></td>
	<td class='rss-block'><a href='../rss/index.php'><img src='../images/byte/rss.gif'></a></td>
	<td class='rss-block'><a href='../rss/index.php'>RSS</a></td>
	<td><img src="../images/byte/rubric-delim-r.gif" class='rubric-delim'></td>
	<td class='rubric-r'><a href='../themes/index.html'>Темы</a></td>
	<td class='rubric-c-r-r'><img src="../images/byte/c-r-r.gif"></td>
	</tr>
	</table>

</TD>
</TR>
<TR>
<TD colspan='2' class='bg-sub-rubric'><img src="../images/byte/bg-sub-rubric.gif"></TD>
</TR>
</TABLE>




<TABLE border="0" cellpadding="0" cellspacing="0" class='main-tbl'>
<TR valign='top'>
<TD width='5'><img src="../images/byte/pix.gif" width="5" height="1" border="0"></TD>
<TD width='250'>

<DIV class='adv'>
<script language="JavaScript">
<!--
var banner_random = Math.round(Math.random() * 100000);
document.write('<iframe name="byte_left_adv" id="byte_left_adv" src="/ad/banners/left.php?banner_random='+banner_random+'" width="250" height="100%" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0" style="max-height:400px;"></iframe>');
// -->
</script>
 <noscript> <iframe width="250" scrolling="no" height="100%" frameborder="0" marginheight="0" marginwidth="0"  style="max-height:400px;" hspace="0" vspace="0" src="../ad/banners/left.php.html" id="byte_left_adv" name="byte_left_adv"></iframe> </noscript> </DIV>

<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='index.php@TYPE_ID=6260.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='index.php@TYPE_ID=6260.html'>Новости</a></td></tr></table><DIV class='block-g'><b><a href='detail.php@ID=25289.html'>Облачные решения Schneider Electric и Microsoft: управление энергоэффективностью и экологичностью</a></b><br />Как объявила компания Schneider Electric, в рамках ее альянса с Microsoft теперь появилась возможность разрабатывать облачные решения для управления &hellip;<br /><br /><b><a href='detail.php@ID=25288.html'>Устройства Lenovo c защитой «АльтЭль»</a></b><br />Компании &laquo;АльтЭль&raquo;, российский разработчик средств защиты информации, и Lenovo объявили о завершении работ по интеграции модуля доверенной загрузки &hellip;<br /><br /><b><a href='detail.php@ID=25286.html'>Год на российском рынке ИБП оказался очень сложным</a></b><br />По данным аналитической компании ITResearch в 2013 г. в России было продано 1,95 млн ИБП на сумму 503,6 млн долл. Годовая динамика составила &ndash;17% в &hellip;<br /><br /><b><a href='detail.php@ID=25285.html'>МФУ Brother Ink Benefit с картриджами повышенной емкости</a></b><br />Компания Brother выпустила новую линейку струйных многофункциональных устройств Ink Benefit, обеспечивающих низкую стоимость печати за счет &hellip;<br /><br /><b><a href='detail.php@ID=25284.html'>Высокоскоростной интерфейс в графических процессорах NVIDIA</a></b><br />Компания NVIDIA объявила о намерении интегрировать высокоскоростной интерфейс NVLink в будущие графические процессоры, что должно ускорить передачу &hellip;<br /><br /><a href='index.php@TYPE_ID=6260.html' class='link'>Другие новости</a></DIV>
<DIV class='adv'>
<script language="JavaScript">
<!--
var banner_random = Math.round(Math.random() * 100000);
document.write('<iframe name="byte_left2_adv" id="byte_left2_adv" src="/ad/banners/left2.php?banner_random='+banner_random+'" width="250" height="100%" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0" style="max-height:120px;"></iframe>');
// -->
</script>
<noscript>
<iframe name="byte_left2_adv" id="byte_left2_adv" src="../ad/banners/left2.php.html" width="250" height="100%" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0" style="max-height:120px;"></iframe>
</noscript></DIV>

<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='index.php@OPINION=1.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='index.php@OPINION=1.html'>Мнения</a></td></tr></table><DIV class='block-g'><a href='detail.php@ID=25262.html'><img src='../upload/iblock/36d/Vaculenko-NEC-50.jpg' alt='В сегменте панелей для видеостен конкурентная борьба идет в технологической сфере' class='tn'></a><b><a href='detail.php@ID=25262.html'>В сегменте панелей для видеостен конкурентная борьба идет в технологической сфере</a></b><br />На рынке информационных панелей, если судить по отчетам аналитиков, растет потенциал и улучшаются перспективы сегмента дисплеев для видеостен. Этот &hellip;<br /><br /><a href='detail.php@ID=24189.html'><img src='../upload/iblock/e10/Gribanov-50.jpg' alt='У рынка планшетов есть много драйверов дальнейшего роста ' class='tn'></a><b><a href='detail.php@ID=24189.html'>У рынка планшетов есть много драйверов дальнейшего роста </a></b><br />В последнее время рынок планшетов бурно развивается. К традиционным планшетам добавились гибридные гаджеты, устройства &laquo;2 в 1&raquo; и масса других &hellip;<br /><br /><a href='detail.php@ID=23635.html'><img src='../upload/iblock/6fe/Maxim-Rubanenko-50.jpg' alt='Основным драйвером ускоренного роста рынка тяжелых ИБП в последние годы являются ЦОДы ' class='tn'></a><b><a href='detail.php@ID=23635.html'>Основным драйвером ускоренного роста рынка тяжелых ИБП в последние годы являются ЦОДы </a></b><br />Любая компания рано или поздно сталкивается с необходимостью обработки данных. Вначале для этого достаточно сервера, затем число серверов и их &hellip;<br /><br /><a href='index.php@OPINION=1.html' class='link'>Другие мнения</a></DIV>
<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='index.html'>Наиболее читаемые</a></td></tr></table><DIV class='block-g'><ul class='list-links'><li><a href='detail.php@ID=25074.html'>Комплекты LifeSize – все для видеоконференцсвязи</a></li><li><a href='detail.php@ID=25041.html'>Видеоконференцсвязь от TrueConf – приложение WebRTC</a></li><li><a href='detail.php@ID=25196.html'>Видеоконференции в среде ALT Linux </a></li><li><a href='detail.php@ID=25115.html'>Облачный и традиционный настольный антивирус: что выбрать?</a></li><li><a href='../bitrix/rk.php@id=375&amp;event1=banner&amp;event2=click&amp;event3=1+%252F+[375]+[TXT2]+Коммутаторы+начального+уровня+апрель+2014&amp;goto=http%253A%252F%252Fwww.bytemag.ru%252Farticles%252Fdetail.php%253FID=25176.html'>Коммутаторы начального уровня</a></li><li><a href='detail.php@ID=25114.html'>Microsoft Lync 2013 по модели SaaS </a></li><li><a href='detail.php@ID=25103.html'>Серверы IBM Power Systems – в облаке для разработчиков </a></li><li><a href='detail.php@ID=25178.html'>Коммутаторы ZyXEL начального уровня</a></li><li><a href='detail.php@ID=25177.html'>От 5 до 16 – Ethernet-коммутаторы для SOHO и малого бизнеса</a></li><li><a href='detail.php@ID=25208.html'>«Большие данные» и новая версия Intel Xeon E7</a></li></ul></DIV>

<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../white-papers/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../white-papers/index.html'>Современные решения</a></td></tr></table><DIV class='block-g'><div class='list-el'><a href='../white-papers/index.php@COMPANY_ID=13245.html'><img src='../upload/iblock/b1d/abbyy.gif' alt='ABBYY' class='wp-logo-last'></a><b><a href='../white-papers/detail.php@ID=13246.html'>ABBYY FineReader Engine 9.0 – передовые технологии распознавания документов для разработчиков программ</a></b></div><div class='list-el'><a href='../white-papers/index.php@COMPANY_ID=13245.html'><img src='../upload/iblock/b1d/abbyy.gif' alt='ABBYY' class='wp-logo-last'></a><b><a href='../white-papers/detail.php@ID=13654.html'>Технологии ABBYY обеспечивают оперативный доступ к архивным документам</a></b></div><div class='list-el'><a href='../white-papers/index.php@COMPANY_ID=12543.html'><img src='../upload/iblock/261/logo100x50.gif' alt='Paragon Software' class='wp-logo-last'></a><b><a href='../white-papers/detail.php@ID=12546.html'>Новая политика лицензирования в обслуживании IT инфраструктуры</a></b></div><div class='list-el'><a href='../white-papers/index.php@COMPANY_ID=19413.html'><img src='../upload/iblock/0d8/logo-eos.gif' alt='«Электронные офисные системы»' class='wp-logo-last'></a><b><a href='../white-papers/detail.php@ID=21403.html'>«ДЕЛО» версии 12.2.1: новые возможности для межведомственного взаимодействия</a></b></div><div class='list-el'><a href='../white-papers/index.php@COMPANY_ID=12719.html'><img src='../upload/iblock/06d/logo-embarcadero.gif' alt='Embarcadero' class='wp-logo-last'></a><b><a href='../white-papers/detail.php@ID=12720.html'>DatabaseGear – инструменты Embarcadero для специалистов по базам данных</a></b></div><a href='../white-papers/index.html' class='link'>Другие решения</a></DIV>
<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../courses/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../courses/index.html'>Учебные курсы</a></td></tr></table><DIV class='block-g'><div class='list-el'><a href='../courses/index.php@COMPANY_ID=18527.html'><img src='../upload/iblock/9ac/Adaptec_by_PMC_100x50.GIF' alt='Adaptec by PMC' class='wp-logo-last'></a><b><a href='../courses/detail.php@ID=19120.html'>Обратно за парту с Adaptec by PMC</a></b></div><div class='list-el'><a href='../courses/index.php@COMPANY_ID=18527.html'><img src='../upload/iblock/9ac/Adaptec_by_PMC_100x50.GIF' alt='Adaptec by PMC' class='wp-logo-last'></a><b><a href='../courses/detail.php@ID=18993.html'>Adaptec Certified Storage Professional</a></b></div><a href='../courses/index.html' class='link'>Другие курсы</a></DIV>

<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../subscribe/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../subscribe/index.html'>Подписка на рассылки</a></td></tr></table><table cellpadding='0' cellspacing='0' border='0' class='block-g'><tr><td><form action='http://www.bytemag.ru/subscribe/subscr_edit.php'><table border='0' width='100%'><tr><td valign='top' align='right'><input type='checkbox' name='sf_RUB_ID[]' id='sf_RUB_ID_1' value='3' checked></td><td><b><label for='sf_RUB_ID_1'>BYTE Express</label></b><br />Анонсы новых статей, последние новости и т.п.</td></tr><tr><td width='15%' nowrap><b>E-mail</b></td><td width='85%'><input type='text' name='sf_EMAIL' size='15' value='' class='100p'></td></tr></table><DIV class='btn-grey'><input type='submit' value='Подписаться' class='200px'></DIV><a href='../subscribe/index.html' class='link'>Управление подпиской</a></form></td></tr></table>
</TD>
<TD width='10'><img src="../images/byte/pix.gif" width="10" height="1" border="0"></TD>
<TD width='560'>

<p>
<script language="JavaScript">
<!--
var banner_random = Math.round(Math.random() * 100000);
document.write('<iframe name="byte_center_adv" id="byte_center_adv" src="/ad/banners/center.php?banner_random='+banner_random+'" width="100%" height="90" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>');
// -->
</script>
<noscript>
<iframe name="byte_center_adv" id="byte_center_adv" src="../ad/banners/center.php.html" width="100%" height="90" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>
</noscript>
</p>
<form name='PrintForm8884' method='post' action='http://www.bytemag.ru/articles/detail_print.php?ID=8884&amp;PRINT=Y' target='_blank'><input type='hidden' name='ACTION' value='PRINT'><input type='hidden' name='SHOW_IMAGE' value='N'></form><br /><TABLE class='tbl-link-services'><TR><TD width='16'><img src='../images/byte/icon-print.gif'></TD><TD><a href='javascript: document.forms["PrintForm8884"].SHOW_IMAGE.value="N"; document.forms["PrintForm8884"].submit();'>Версия для печати</a> (<a href='javascript: document.forms["PrintForm8884"].SHOW_IMAGE.value="Y"; document.forms["PrintForm8884"].submit();'>включая изображения</a>)</TD><TD width='16'><img src='../images/byte/icon-mail.gif'></TD><TD><a href='javascript:SendLink(8884);'>Отправить ссылку</a></TD><TD width='16'><img src='../images/byte/icon-blog.gif'></TD><TD><a href='detail.php@ID=8884.html#add-blog'>Поместить в блог</a></TD><TD width='16'><img src='../images/byte/icon-forum.gif'></TD><TD><a href='detail.php@ID=8884.html#add-comment'>Добавить комментарий</a></TD><TD width='16'><img src='../images/byte/icon-author.gif'></TD><TD><a href='javascript:SendAuthor(8884);'>Написать автору</a></TD><TD width='16'><img src='../images/byte/icon-subscribe.gif'></TD><TD><a href='../subscribe/index.html'>Подписаться на рассылки</a></TD></TR></TABLE><br /><p><b>Раздел:</b> <a href='index.php@TYPE_ID=6256.html'>Средства разработки</a><br /></p><a href='../numbers/index.php@ID=11547.html'>№11 (40), ноябрь 2001</a><h1>Разработка Smart Tags в виде ActiveX DLL
</h1>11.11.2001<p></p><DIV class='article-text'><p><i>Андрей Колесов</i>
<p>Для чтения этой статьи желательны некоторые познания в разработке COM-объектов 
  и языке Visual Basic. Полный вариант рассмотренного здесь программного проекта 
  (файл AndyTest.ZIP, 16 Кбайт) можно найти на сайте <a href="../index.html">http://www.bytemag.ru</a>. 
  Для работы с исходными кодами понадобится инструментарий Visual Basic версии 
  5.0 или старше и библиотека Microsoft Smart Tags 1.0 Type Library, а для тестирования 
  - Word 2002. 
<p>В предыдущей статье серии (&quot;<a href="http://www.bytemag.ru/Article.asp?id=500">Smart Tags в офисных 
  приложениях Microsoft</a>&quot;, &quot;BYTE/Россия&quot; №10) мы начали изучать новую технологию 
  &quot;интеллектуальной обработки текстов&quot; Smart Tags, впервые реализованную в Office 
  XP. Мы посмотрели, что она представляет собой с точки зрения пользователя, какие 
  готовые средства есть в составе пакета, вкратце рассмотрели принципы программного 
  управления смарт-тегами в среде VBA (в приложениях Word 2002 и Excel 2002) и 
  создание простейших обработчиков смарт-тегов в виде XML-описателей. 
<p>Хотелось бы сразу подчеркнуть, что мы показали только некоторые основные моменты разработки XML-распознавателей - инструментарий предоставляет целый ряд дополнительных возможностей, связанных в основном с динамическим обновлением списков терминов, в том числе с применением ссылок на удаленные Web-ресурсы. Тем не менее понятно, что функциональность XML-обработчиков (создание которых по силам любому пользователю, имеющему под рукой простейший редактор типа NotePad) весьма ограниченна. Процесс распознавания слов там сводится к тривиальному сравнению со списками терминов, а реализуемые действия - к заданию строки &quot;Address&quot; при обращении к Internet Explorer (ссылка на Web-ресурс, инициализация написания нового письма и т. п.).
<p>Более широкие функциональные возможности предоставляет второй вариант реализации обработчиков смарт-тегов - в виде библиотек ActiveX DLL. Именно его мы и рассмотрим в данной статье. Хотелось бы подчеркнуть, что на примере создания DLL-распознавателей очень хорошо видна внутренняя логика работы самой технологии Smart Tags.
<h3>Терминология и логика работы </h3>
<p>Прежде чем перейти к разработке DLL-обработчиков смарт-тегов, нужно определиться с терминологией. Это очень важно, так как сейчас, на начальном этапе освоения технологии (и при не очень точном переводе на русский язык английской исходной документации, которая тоже не самого лучшего качества), уже начинается определенная путаница в понятиях -- например, не всегда до конца ясно, что же такое собственно &quot;смарт-тег&quot;.
<p>В рассматриваемой технологии имеются два основных типа компонентов:
<p><b>Обработчик смарт-тегов</b> (его иногда - даже в документации SDK - называют 
  собственно &quot;смарт-тегом&quot;, что только запутывает ситуацию), реализуемый в виде 
  XML-описателей или ActiveX DLL. Каждый обработчик характеризуется набором уникальных 
  идентификаторов, которые почему-то в данном случае называются &quot;типом&quot; (чаще 
  всего набор состоит из одного типа). Каждый обработчик имеет два функциональных 
  блока - распознаватель (recognizer) и исполнитель действия (action). Первый 
  выполняет анализ текста и привязку найденных фрагментов к данному распознавателю 
  (точнее, к конкретному идентификатору распознавателя, типу смарт-тега). Второй 
  выполняет операции по запросу пользователя (при выборе меню &quot;Действия для смарт-тегов&quot;), 
  опять же устанавливая нужные связи с помощью идентификатора типа. 
<p><b>Смарт-тег.</b> Это фрагмент текста документа (например, отдельное слово), 
  распознанный одним из обработчиков, с присоединенной к нему (фрагменту) дополнительной 
  метаинформацией. Обязательный элемент этой информации - идентификатор распознавателя 
  (тип смарт-тега); собственно, именно это отличает смарт-тег от обычного текста. 
  Кроме того, в метаданные может входить набор дополнительных свойств (об этом 
  немного говорилось в предыдущей статье). 
<p>Следует обратить внимание еще на два очень важных момента. Во-первых, набор присоединенных метаданных может сохраняться при передаче документа с компьютера на компьютер или просто при физическом удалении файла распознавателя. Во-вторых, поскольку смарт-тег - это связка фрагмента текста и распознавателя, то очевидно, что один и тот же фрагмент может входить в состав разных смарт-тегов.
<p>Поясним сказанное на примере. Для этого введем в документе Word 2002 фразу из двух слов:
<p>
<pre>Cough, Бейсик</pre>
<p>
<p>В прошлый раз мы создали два XML-обработчика, в первом из которых (medical.xml) в списке терминов описано только слово &quot;cough&quot;, а во втором (andy.xml) - оба слова. Соответственно, оба слова в документе будут выделены подчеркиванием, но за первым будут закреплены два распознавателя, т. е. фрагмент &quot;cough&quot; будет входить в состав двух разных смарт-тегов (рис. 1). Чтобы убедиться в этом, напишем и выполним такую макрокоманду:
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict1.gif" alt=Fig.1></td></tr>
<tr><td valign="bottom">Рис. 1. Один фрагмент текста может входить в состав двух разных смарт-тегов.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<table border="0">
<tr bgcolor="#CCCCCC"> <td> 
<pre>Sub SmartTagAllXML()
&#39;
&#39; Вывод XML-описаний всех смарт-тегов
&#39; документа 
 Dim i%
 With ActiveDocument
    For i = 1 To .SmartTags.Count
      .ActiveWindow.Selection.TypeText _
         i & &quot;  / &quot; & _
        ActiveDocument.SmartTags(i).XML _
        & vbCrLf
    Next
End Sub</pre>
</td></tr></table>
<p>
<p>В результате мы получим распечатку:
<p>
<table border="0">
<tr bgcolor="#CCCCCC"> <td> 
<pre>1. &lt;xml xmlns:st1=
     &quot;urn:schemas-adatum-com:medical&quot;&gt;
     &lt;st1:Newcondition&gt;Cough
     &lt;/st1:Newcondition&gt;
   &lt;/xml&gt;
2. &lt;xml xmlns:st1=
     &quot;urn:schemas-andy-com:basic&quot;&gt;
     &lt;st1:terms&gt;Cough&lt;/st1:terms&gt;
   &lt;/xml&gt;
3. &lt;xml xmlns:
     st1=&quot;urn:schemas-andy-com:basic&quot;&gt;
     &lt;st1:terms&gt;Бейсик&lt;/st1:terms&gt;
   &lt;/xml&gt;</pre>
</td></tr></table>
<p>
<p>Но самое интересное нас ожидает далее. Запишем документ в режиме сохранения внедренных смарт-тегов, потом удалим файл Medical.XML, перезагрузим Word 2002 с этим же документом и запустим макрокоманду SmartTagAllXML. В распечатке мы увидим все те же три смарт-тега, хотя для первого из них обработчика уже не существует. Этот смарт-тег будет удален из документа только после того, как мы выполним обновление смарт-тегов с помощью кнопки &quot;Повторная проверка&quot; в диалоговом окне &quot;Сервис | Автозамена | Смарт-теги&quot;.
<p>Эта возможность сохранения смарт-тегов в документе (при его передаче с одного компьютера на другой, где могут быть совсем другие наборы распознавателей) представляется очень любопытной. В некоторых ее нюансах нужно еще разбираться, чтобы понять, какую практическую пользу может принести данное новшество. К этому вопросу мы еще вернемся в будущем, а пока начнем создавать обработчик смарт-тегов в виде ActiveX DLL.
<h3>Основные элементы интерфейса </h3>
<p>Для создания DLL-обработчика нужна библиотека типов Microsoft Smart Tags 1.0, которая входит в состав Office XP. Она включает четыре интерфейса:
<p><b>ISmartTagRecognizer</b> - распознаватель, который связывает фрагменты текста 
  с данным обработчиком. Эти фрагменты выделяются в документе как смарт-теги с 
  помощью подчеркивания, при этом выводится кнопка &quot;Действия для смарт-тегов&quot;. 
<p><b>ISmartTagAction</b> - выполняет обработку смарт-тега. Обращение к этому 
  интерфейсу происходит при нажатии кнопки &quot;Действия для смарт-тегов&quot; - сначала 
  выдается меню с перечнем возможных команд обработки (рис. 1), а при выборе нужной 
  команды выполняется сама операция. 
<p><b>ISmartTagRecognizerSite</b> - обработка объекта Excel или Word, который 
  показывает место фрагмента в документе, куда нужно добавить смарт-тег. 
<p><b>ISmartTagProperties</b> - доступ к набору свойств смарт-тега, представленному 
  парами ключей и значений. 
<p>Первые два интерфейса - основные, обязательные (два других реализуют некоторые 
  расширенные функции, которые мы не будем рассматривать в этой статье). В таблице 
  приведены их элементы - названия, описания, а также соответствующие им по функциональному 
  назначению теги XML-обработчиков. 
<h4>Основные элементы программного интерфейса Smart Tags </h4>
<p>
<table width="100%" border="1">
  <tr> 
    <td><b>Название элементов</b></td>
    <td><b>Тег-аналог XML-обработчика</b></td>
    <td><b>Описание</b></td>
  </tr>
  <tr> 
    <th colspan="3">Интерфейс IsmartTagRecognizer</th>
  </tr>
  <tr> 
    <td>Desc (свойство)</td>
    <td> 
      <pre>&lt;FL:description&gt;</pre>
    </td>
    <td>Описание распознавателя смарт-тегов</td>
  </tr>
  <tr> 
    <td>Name (свойство)</td>
    <td> 
      <pre>&lt;FL:name&gt;</pre>
    </td>
    <td>диалогового окна &quot;Сервис | Автозамена | Смарт-теги</td>
  </tr>
  <tr> 
    <td>ProgID (свойство)</td>
    <td>Нет аналога</td>
    <td>Уникальный идентификатор класса распознавателя. Используется для регистрации 
      DLL</td>
  </tr>
  <tr> 
    <td>Recognize (метод)</td>
    <td>Нет аналога</td>
    <td>Операция распознавания фрагмента текста</td>
  </tr>
  <tr> 
    <td>SmartTagCount (свойство)</td>
    <td>Нет аналога</td>
    <td>Количество типов смарт-тегов в данном распознавателе (в XML-обработчике 
      содержится только один тип)</td>
  </tr>
  <tr> 
    <td>SmartTagDownloadUR (свойство)</td>
    <td> 
      <pre>&lt;FL:moreinfourl&gt;</pre>
    </td>
    <td>URL-ссылка на Web-ресурс, которая используется для выполнения дополнительной 
      команды &quot;Проверка новых действий</td>
  </tr>
  <tr> 
    <td>SmartTagName (свойство)</td>
    <td>Атрибут type тега 
      <pre>&lt;FL:smartag&gt;</pre>
    </td>
    <td>Уникальные идентификаторы для каждого типа смарт-тегов в данном распознавателе. 
      (Это то, что выше мы называли типом распознавателя для XML-обработчика, 
      но сейчас их может быть несколько)</td>
  </tr>
  <tr> 
    <th colspan="3">Интерфейс IsmartTagAction</th>
  </tr>
  <tr> 
    <td>Desc (свойство)</td>
    <td> 
      <pre>&lt;FL:description&gt;</pre>
    </td>
    <td>Описание обработчика смарт-тегов</td>
  </tr>
  <tr> 
    <td>Name (свойство)</td>
    <td> 
      <pre>&lt;FL:name&gt;</pre>
    </td>
    <td>Название обработчика. Это имя появляется в заголовке меню &quot;Действия смарт-тегов</td>
  </tr>
  <tr> 
    <td>ProgID (свойство)</td>
    <td>Атрибут id тега 
      <pre>&lt;FL:action&gt;</pre>
    </td>
    <td>Уникальный идентификатор класса обработчика</td>
  </tr>
  <tr> 
    <td>InvokeVerb (метод)</td>
    <td>Нет аналога</td>
    <td>Операция, которая выполняется при выборе команды меню &quot;Действия смарт-тегов</td>
  </tr>
  <tr> 
    <td>SmartTagCount (свойство)</td>
    <td>Нет аналога</td>
    <td>Количество типов смарт-тегов, которые поддерживаются соответствующим распознавателем</td>
  </tr>
  <tr> 
    <td>SmartTagName (свойство)</td>
    <td>Атрибут Type тега 
      <pre>&lt;FL:smartag&gt;</pre>
    </td>
    <td>Уникальные идентификаторы для каждого типа смарт-тегов в данном обработчике 
    </td>
  </tr>
  <tr> 
    <td>VerbCaptionFromID (свойство)</td>
    <td> 
      <pre>&lt;FL:action&gt;&lt;FL:caption&gt;</pre>
    </td>
    <td>Название действия, которое прописывается в меню &quot;Действия смарт-тегов</td>
  </tr>
  <tr> 
    <td>VerbCount (свойство)</td>
    <td>Считает автоматически</td>
    <td>Число операций обработки для данного типа смарт-тегов</td>
  </tr>
  <tr> 
    <td>VerbID (свойство)</td>
    <td>Нет аналога</td>
    <td>Свойство, которое возвращает уникальный ID (используемый внутри конкретного 
      приложения) в пределах данного смарт-тега. Этот механизм реализован так, 
      что DLL-обработчики могут смешивать разные виды обработки для различных 
      типов смарт-тегов </td>
  </tr>
  <tr> 
    <td>VerbNameFromID (свойство)</td>
    <td>Нет аналога</td>
    <td>Свойство, которое возвращает имя (используемое внутри конкретного приложения) 
      для представления данного вида обработки смарт-тегов. Например, для названия 
      действия View Microsoft Web site это свойство вернет что-то вроде viewMSWebsite</td>
  </tr>
</table>
<p>Даже из беглого знакомства с этими элементами видно, что DLL-обработчик реализует 
  более широкий набор функций, чем XML-обработчик. Например, он фактически может 
  включать несколько типов распознавателей (распознавать несколько типов смарт-тегов) 
  и соответствующее им число обработчиков. Для этого понадобится дополнительная 
  функция идентификации операции на уровне одного класса. Кроме того, очевидно, 
  что некоторые свойства двух интерфейсов по определению должны быть одинаковыми 
  (например, SmartTagCount). 
<p>Попробуем начать разработку реального DLL-обработчика - скорее всего, многое прояснится по ходу дела, хотя наверняка появятся и новые вопросы.
<h3>Создание DLL-обработчика </h3>
<h4>DLL-проект </h4>
<p>В предыдущей статье, создавая свой XML-обработчик, мы обнаружили некоторые проблемы при обработке русских терминов (в частности, для различных склонений слов и разных регистров букв). Попробуем их решить с помощью DLL-обработчика. 
<p>Создать его можно с помощью любого инструмента, которые позволяет разрабатывать ActiveX DLL. Я буду использовать для этого Visual Basic 5.0 (при желании можно применить и VB 4.0). Для разработки потребуется также библиотека Microsoft Smart Tags 1.0 Type Library (MSTAG.TBL, объем 5 Кбайт), поставляемая в составе Office XP, в том числе в Standard Edition.
<p>Для начала выполним следующие операции в среде VB:
<ol>
  <li>Создадим новый проект типа ActiveX DLL и назовем его AndySimpleTest. </li>
  <li>Установим ссылку на библиотеку Microsoft Smart Tags 1.0 Type Library (команда 
    Project | References). </li>
  <li>Имя модуля класса Class1 (свойство Name) поменяем на SmartTagRecognizer 
    и для подключения нужного программного интерфейса в разделе объявлений окна 
    кода введем строку: <br>
     <pre>Implements ISmartTagRecognizer</pre>
  </li>
  <li>Добавим к проекту еще один модуль класса (Project | Add Class Module), дадим 
    ему имя SmartTagActionRecognizer и в разделе объявлений введем строку:<br>
     <pre>Implements ISmartTagAction</pre>
  </li>
  <li>Добавим к проекту обычный BAS-модуль и назовем его PublicConst.</li>
  <li>Убедимся, что в окне Project | AndySimpleTest | Component установлен переключатель 
    Project Compatibility.</li>
  <li>Сохраним проект. </li>
</ol>
<p>Теперь приступим к программированию. 
<h4>Определение глобальных констант </h4>
<p>Выше мы уже отмечали, что два интерфейса обработчика используют ряд явно общих параметров. Конечно, можно &quot;аккуратно&quot; продублировать строки кода в разных модулях, но с методической точки зрения это неверно - тем самым мы создадим потенциальную опасность для надежности программы. Именно для того, чтобы избежать такого риска, мы включили в проект обычный модуль PublicConst, где будем хранить общие глобальные константы:
<p>
<table border="0">
<tr bgcolor="#CCCCCC"> <td> 
<pre>&#39; В простейшем варианте у нас будет
&#39; два типа смарт-тегов
Public Const SmartTagCountX As Long = 2

&#39; Конкретное имя будет формироваться 
&#39; путем прибавления к этой константе 
&#39; уникального цифрового суффикса
Public Const SmartTagNameX As String = _
   &quot;Andy-Simple-Test#SmartTags&quot;</pre>
</td></tr></table>
<p>
<h4>Программирование интерфейса распознавания </h4>
<p>Начнем с интерфейса ISmartTagRecognizer, который реализуется в модуле класса SmartTagRecognizer. На рис. 2 хорошо видны процедуры, которые мы должны сформировать. Обратите внимание, что все свойства интерфейса используются в режиме &quot;только для чтения&quot;.
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict2.gif" alt=Fig.2></td></tr>
<tr><td valign="bottom">Рис. 2. Все эти элементы интерфейса ISmartTagRecognizer нужно сформировать.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<p>Сначала введем код для определения свойств ProgID, Name и Desc:
<p>
<table border="0">
<tr bgcolor="#CCCCCC"> <td> 
<pre>Private Property Get _
  ISmartTagRecognizer_ProgID() As String
  &#39; Идентификатор должен быть уникальным!
  &#39; Он должен точно совпадать 
  &#39;с именем проекта и модуля класса!
  ISmartTagRecognizer_ProgID = _
    &quot;AndySimpleTest.SmartTagRecognizer&quot;
End Property

Private Property Get _
  ISmartTagRecognizer_Name  _
   (ByVal LocaleID As Long) As String
  &#39; Можем учитывать региональные 
  &#39; установки для выбора языка
  If LocaleID = 1049 Then &#39; Russian
    ISmartTagRecognizer_Name = _
      &quot;Простой распознаватель смарт-тегов&quot;
  Else
    ISmartTagRecognizer_Name = _
      &quot;Simple Smart Tag Recognizer&quot;
  End If
End Property

Private Property Get _
  ISmartTagRecognizer_Desc _
   (ByVal LocaleID As Long) As String
  &#39; Тут мы тоже можем учитывать региональные 
  &#39; установки, но сейчас не будем 
  ISmartTagRecognizer_Desc = _
   &quot;Directs user to some resources&quot;
End Property</pre>
</td></tr></table>
<p>
<p>В этом коде следует обратить внимание на следующие два момента. Во-первых, идентификатор ProgID должен быть не только уникальным, но и точно совпадать с именем проекта и модуля класса. С теоретической точки зрения эта конструкция не очень правильная, так как в ней заложена потенциальная опасность расхождения (из-за тривиальной опечатки при вводе или при коррекции имени проекта). Во-вторых, мы можем учитывать региональные установки конкретного компьютера для вывода служебных текстов на подходящем языке. Впрочем, не очень понятно, где задается LocaleId - то ли в системной установке OC, то ли еще где-то (например, Word может сам распознавать основной язык текста). 
<p>Запишем код для определения свойств SmartTagCount, SmartTagName и SmartTagDownLoadURL:
<p>
<table border="0">
<tr bgcolor="#CCCCCC"> <td> 
<pre>Private Property Get _
   ISmartTagRecognizer_SmartTagCount() _
     As Long
  &#39; Используем глобальную константу!
  ISmartTagRecognizer_SmartTagCount = _
    SmartTagCountX
End Property

Private Property Get _
  ISmartTagRecognizer_SmartTagName _
   (ByVal SmartTagID As Long) As String
  &#39; Формируем уникальное имя (тип) 
  &#39; смарт-тега с помощью глобальной 
  &#39; константы и порядкового номера 
  &#39; смарт-тега, например:
  &#39;  &quot;Andy-Simple-Test#SmartTags1&quot;
  ISmartTagRecognizer_SmartTagName = _
    SmartTagName & SmartTagID
End Property

Private Property Get _
ISmartTagRecognizer_SmartTagDownloadURL _
   (ByVal SmartTagID As Long) As String
  &#39; Тут тоже можно задать разные ссылки 
  &#39; (за дополнительной информацией)
  &#39;  для различных типов смарт-тегов
If SmartTagID = 1 Then
 ISmartTagRecognizer_SmartTagDownloadURL _
      = &quot;http://visual.2000.ru/develop/&quot;
Else
 ISmartTagRecognizer_SmartTagDownloadURL _
      = Null
End If
End Property</pre>
</td></tr></table>
<p>
<p>В этом коде нам пригодились глобальные константы, сформированные ранее. Здесь в качестве передаваемого параметра используется SmartTagID - он обозначает порядковый номер типа смарт-тега в данном обработчике и может изменяться от 1 до SmartTagCount. С его помощью формируется уникальное имя типа каждого смарт-тега, он же может использоваться для задания различных ссылок на дополнительную информацию.
<p>Зададим список искомых терминов:
<p>
<table border="0">
<tr bgcolor="#CCCCCC"> <td> 
<pre>Dim MyTerms$(1 To 4)

Private Sub Class_Initialize()
  &#39; Формирование списка терминов
  MyTerms(1) = &quot;фортран&quot;
  MyTerms(2) = &quot;fortran&quot;
  MyTerms(3) = &quot;си++&quot;
  MyTerms(4) = &quot;c++&quot;
End Sub</pre>
</td></tr></table>
<p>
<p>Тут нужно отметить, что список терминов можно получить многими способами, в том числе из внешних файлов (например, из адресной книги или папок Outlook). Именно поэтому его следует формировать при инициализации класса. Но в общем случае термины могут быть и не нужны - ведь распознавание может выполняться не только прямым сравнением строк.
<p>4. Теперь напишем код для метода Reсognize (листинг 1). Изучим его внимательно, 
  так как на его примере видна логика работы распознавателя смарт-тегов. Сначала 
  разберемся с входными параметрами. Text - это текстовая строка с обрабатываемым 
  фрагментом. LocateID - значение региональной установки (в данном случае мы ее 
  не используем, но, наверное, она может пригодиться). 
<p>&nbsp;
<table width="100%" border="0" bgcolor="#66FFCC">
  <tr> 
    <th>
      <p>Листинг 1. Метод распознавания смарт-тегов в интерфейсе IsmartTagRecognizer
    </th>
  </tr> 
<tr> 
    <td><pre>Private Sub _
  ISmartTagRecognizer_Recognize _
  (ByVal Text As String, _
  ByVal DataType As SmartTagLib.IF_TYPE, _
  ByVal LocaleID As Long, _
  ByVal RecognizerSite As _
  SmartTagLib.ISmartTagRecognizerSite)
  &#39;
  &#39; Распознавание фрагмента текста
  &#39; Text - фрагмент текста
  &#39; DataType -- тип обрабатываемых данных
  
  Dim i As Integer, iConut As Integer
  Dim index As Integer
  Dim termlen As Integer
  Dim CurrentSmartTagName$
  Dim propbag As _
    SmartTagLib.ISmartTagProperties
  Text = LCase(Text)  &#39; убираем регистр
  &#39;
  &#39; сравниваем для каждого распознавателя
    
  &#39; 1. Контекстный поиск заданных терминов
  CurrentSmartTagName$ = _
    ISmartTagRecognizer_SmartTagName(1)
  For i = LBound(MyTerms) _
      To UBound(MyTerms)
    termlen = Len(MyTerms(i))
    &#39; первый поиск
    index = InStr(Text, MyTerms(i))  
    While index &gt; 0
      &#39; установка смарт-тега
      GoSub SetNewSmartTag  
      &#39; ищем дальше
      index = InStr(index + termlen, _
        Text, MyTerms(i))
    Wend
  Next i
    
  &#39; 2. Выборка первого термина в {}
  CurrentSmartTagName$ = _
    ISmartTagRecognizer_SmartTagName(2)
  index = InStr(Text, &quot;{&quot;)
  If index &gt; 0 Then
    termlen = InStr(index + 1, Text, &quot;}&quot;)
    If termlen &gt; 0 Then
      termlen = termlen - index + 1
      &#39; установка смарт-тега
      GoSub SetNewSmartTag  
    End If
  End If
Exit Sub
          
&#39; формирование нового смарт-тега
SetNewSmartTag:  
  &#39; Запрашиваем у RecognizerSite 
  &#39;объект для хранения свойств
  Set propbag = _ 
     RecognizerSite.GetNewPropertyBag
      &#39; подключаем смарт-тег к приложению
    RecognizerSite.CommitSmartTag _
      CurrentSmartTagName$, _
      index, termlen, propbag
  Return
End Sub</pre></td>
  </tr>
</table>
<p>DataType - это числовой код, описывающий тип обрабатываемого текста, а точнее, 
  указывающий, в какой момент ввода текста выполняется обращение к распознавателю: 
<p>
<table border="0">
<tr bgcolor="#CCCCCC"> <td> 
<pre>  &#39; при вводе отдельного символа:
IF_TYPE_CHAR      =0x00000001  
  &#39; при вводе отдельного слова:
IF_TYPE_SINGLE_WD =0x00000002,
  &#39; после фильтрации текста по шаблону:
IF_TYPE_REGEXP    =0x00000004,
  &#39; при вводе абзаца:
IF_TYPE_PARA      =0x00000008,
  &#39; при вводе ячейки:
IF_TYPE_CELL      =0x00000010, </pre>
</td></tr></table>
<p>
<p>В настоящее время задействованы только два последних режима, остальные зарезервированы на будущее. Очевидно, это даст возможность распознавателю самому определять, в каком режиме нужно обрабатывать текст. (Так написано в документации; мое тестирование показало, что обращение происходит после ввода каждого слова.)
<p>RecognizerSite - это объект хост-приложения (Word, Excel), который выполняет нужные действия для внедрения смарт-тегов.
<p>В методе Recognize мы реализовали два варианта анализа текста. В первом выполняется контекстный поиск заданных в массиве MyTerms терминов, а во втором -- в тексте ищется первый фрагмент, заключенный в фигурные скобки, например {Вася}.
<h4>Программирование интерфейса обработки ISmartTagAction </h4>
<p>Код, определяющий свойства ProgID, Name, Desc, SmartTagCount, SmartTagName 
  и SmartTagCaption, будет выглядеть примерно так же, как и для интерфейса ISmartTagRecognizer 
  (листинг 2). Тут только стоит обратить внимание, что заголовок меню &quot;Действия 
  смарт-тегов&quot; можно устанавливать в соответствии с типом смарт-тега. 
<p>&nbsp;
<table width="100%" border="0" bgcolor="#66FFCC">
  <tr> 
    <th>
      <p>Листинг 2. Код для определения статических свойств интерфейса IsmartTagAction
    </th>
  </tr>
<tr><td><pre>Private Property Get _ 
   ISmartTagAction_Desc _
   (ByVal LocaleID As Long) As String
  ISmartTagAction_Desc = _
    &quot;Provides actions for some terms&quot;
End Property

Private Property Get _
  ISmartTagAction_Name _
  (ByVal LocaleID As Long) As String
  If LocaleID = 1049 Then &#39; Russian
    ISmartTagRecognizer_Name = _
      &quot;Простая обработка смарт-тегов&quot;
  Else
    ISmartTagRecognizer_Name = _
      &quot;Simple Smart Tag Action&quot;
  End If
End Property

Private Property Get _
  ISmartTagAction_ProgId() As String
    ISmartTagAction_ProgId = _
      &quot;AndySimpleTest.SmartTagAction&quot;
End Property

Private Property Get _
  ISmartTagAction_SmartTagCaption _
   (ByVal SmartTagID As Long, _
   ByVal LocaleID As Long) As String
  &#39; То, что появится в заголовке меню:
  If SmartTagID = 1 Then
    If LocaleID = 1049 Then &#39; Russian
      ISmartTagAction_SmartTagCaption = _
        &quot;Простая обработка терминов&quot;
    Else
      ISmartTagAction_SmartTagCaption = _
        &quot;Simple actions&quot;
    End If
  Else
    ISmartTagAction_SmartTagCaption = _
      &quot;Термин в фигурных скобках&quot;
  End If
End Property

Private Property Get _
  ISmartTagAction_SmartTagCount() As Long
  ISmartTagAction_SmartTagCount = _
    SmartTagCountX
End Property

Private Property Get _
  ISmartTagAction_SmartTagName _
   (ByVal SmartTagID As Long) As String
   ISmartTagRecognizer_SmartTagName = _
     SmartTagNameX & SmartTagID
End Property</pre></td>
  </tr>
</table>
<p>А вот с кодом для набора свойств, формирующих меню &quot;Действия смарт-тегов&quot; (листинг 
  3), нужно познакомиться внимательнее. Он выглядит довольно запутанно, но на 
  самом деле разобраться можно. 
<p>&nbsp;
<table width="100%" border="0" bgcolor="#66FFCC">
  <tr> 
    <th>
      <p>Листинг 3. Формирование меню &quot;Действия смарт-тегов&quot;
    </th>
  </tr>
<tr><td><pre>Private Property Get _
  ISmartTagAction_VerbCount _
   (ByVal SmartTagName As String) As Long
  &#39; Сколько действий предлагается 
  &#39; для данного типа смарт-тега
  Select Case SmartTagName
    Case ISmartTagAction_SmartTagName(1)
      ISmartTagAction_VerbCount = 3
    Case ISmartTagAction_SmartTagName(2)
      ISmartTagAction_VerbCount = 2
  End Select
End Property

Private Property Get _
   ISmartTagAction_VerbID _
    (ByVal SmartTagName As String, _
    ByVal VerbIndex As Long) As Long
  &#39; Выбираем номер команды из общего
  &#39; списка команд
 If SmartTagName = _
   ISmartTagAction_SmartTagName(1) Then
    &#39; выбираются с первого номера
   ISmartTagAction_VerbID = VerbIndex 
 Else &#39;с третьего номера
   ISmartTagAction_VerbID = VerbIndex + 2  
 End If
End Property

Private Property Get _
   ISmartTagAction_VerbCaptionFromID _
   (ByVal VerbID As Long, _
   ByVal ApplicationName As String, _
   ByVal LocaleID As Long) As String
   
 &#39; Здесь формируются названия команд
 &#39; в меню &quot;Действие смарт-тегов&quot;
 Select Case VerbID
  Case 1
    ISmartTagAction_VerbCaptionFromID = _
      &quot;1. www.microsoft.com&quot;
  Case 2
    ISmartTagAction_VerbCaptionFromID = _
      &quot;2. www.pcweek.ru&quot;
  Case 3
    ISmartTagAction_VerbCaptionFromID = _
      &quot;3. www.bytemag.ru&quot;
  Case 4
    ISmartTagAction_VerbCaptionFromID = _
      &quot;4. Выдача сообщения&quot;
 End Select
End Property

Private Property Get _
  ISmartTagAction_VerbNameFromID _
  (ByVal VerbID As Long) As String
  &#39; Это свойство нужно только для 
  &#39;работы с объектной моделью Excel
  &#39; с этим будем разбираться позднее...
  ISmartTagAction_VerbNameFromID = _
    &quot;AndySimpleTest&quot; & VerbID
End Property</pre></td>
  </tr>
</table>
<p>Обращение ко всем четырем свойствам - IsmartTagAction_VerbCount, IsmartTagAction_VerbID, 
  IsmartTagAction_VerbCaptionFromID и IsmartTagAction_VerbNameFromID - происходит 
  в момент нажатия кнопки &quot;Действие смарт-тегов&quot; для формирования соответствующего 
  меню. Тут дело в том, что обработчик имеет единый список команд выполнения действий 
  для всех типов смарт-тегов (распознавателей), описанных в нем. В нашем примере 
  имеются четыре такие команды (см. IsmartTagAction_VerbCaptionFromID) для обоих 
  типов смарт-тегов. Один из них использует первые три команды, а второй - две 
  последние, т.е. третья команда (строка &quot;www.bytemag.ru&quot;) задействована в обоих 
  вариантах. 
<p>Посмотрим, как это работает. При выборе кнопки &quot;Действия смарт-тегов&quot; происходит обращение к свойству IsmartTagAction_VerbCount, которое возвращает число команд, закрепленных за данным типом смарт-тега (SmartTagName). Далее формируется меню. Для каждого индекса меню (VerbIndex) определяется название команды, соответствующей данной позиции. Для этого сначала определяется номер команды (VerbID), а потом по этому номеру - само название (VerbCaptionFromID). Тут нужно отметить, что название может уточняться с учетом региональных установок (LocaleID) и конкретного приложения (ApplicationName). Одновременно идет формирование свойства VerbNameFromID, которое используется в объектной модели Excel, но с ним мы сейчас разбираться не будем.
<p>И наконец, метод InvokeVerb реализует операции, выполняемые при выборе соответствующей позиции меню &quot;Действия для смарт-тегов&quot;.
<p>Тут основной параметр - опять же VerbID (еще раз - это не номер позиции меню, которую вы видите на экране, а некий номер-идентификатор списка команд, общего для всех распознавателей данного обработчика). Но на самом деле для уточнения команды или передаваемых в нее параметров можно использовать и другие сведения о данном смарт-теге - ApplicationName, Text (это сам фрагмент документа), Properties и XML (набор свойств и XML-описание смарт-тега).
<p>Особо отметим параметр Target - ссылку на объект, содержащий данный смарт-тег. В документации говорится, что он обычно представляет собой объект документа типа Range (что вполне отвечает здравому смыслу), но может быть пустым, Null (что не очень понятно). В общем, с ним нужно разбираться отдельно.
<h4>Компиляция и регистрация DLL-обработчика </h4>
<p>Для создания ActiveX DLL нужно просто выбрать команду &quot;File | Make&quot;. А вот для регистрации обработчика смарт-тегов нужно немного поработать руками.
<p>В первую очередь нашу библиотеку AndySimpleTest.DLL нужно зарегистрировать на компьютере в качестве ActiveX-сервера. Сейчас это не нужно делать специально, так как такая регистрация выполняется автоматически при создании исполняемого модуля. Если же вы запишете полученный файл на другой ПК, то нужно будет выполнить команду:
<p>
<pre>Regsvr32.exe AndySimpleTest.DLL</pre>
<p>
<p>Но чтобы DLL могла работать в качестве обработчика смарт-тегов, необходимо с помощью утилиты Regedit.exe прописать в системный Реестр еще два ключа - для распознавателя и исполнителя действий. Откройте в Реестре раздел HKEY_CURRENT_USER\Software\Microsoft\Office\Common\Smart Tag, который содержит две папки - Recognizers и Actions. В каждой из них создайте по одному новому ключу, в которые введите полные идентификаторы ProgID двух созданных нами классов - соответственно AndySimpleTest.SmartTagRecognizer и AndySimpleTest.SmartTagAction (рис. 3).
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict3.gif" alt=Fig.3></td></tr>
<tr><td valign="bottom">Рис. 3. Регистрация DLL-обработчиков смарт-тегов в Реестре.
<hr noshade align="left" size="0">
</td></tr>
</table>
<h3>Тестирование </h3>
<p>А теперь загрузим Word 2002 и посмотрим, как будет работать наш DLL-обработчик смарт-тегов.
<p>Для начала откроем окно &quot;Сервис | Автозамена | Смарт-теги&quot; и убедимся, что в списке &quot;Распознаватели&quot; появилась строка &quot;Простой распознаватель смарт-тегов&quot; (рис. 4). Отметим, что это соответствует свойству SmartTagRecognizer_Name, которое правильно среагировало на региональную установку компьютера (русский, 1049).
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict4.gif" alt=Fig.4></td></tr>
<tr><td valign="bottom">Рис. 4. Список распознавателей пополнился созданной нами библиотекой DLL.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<p>Введем в Word 2002 такой текст &quot;На Фортране {Фортран} я написал довольно много программ&quot; и убедимся, что в нем подчеркиванием выделены два фрагмента - &quot;Фортран&quot; (без окончания) и &quot;{Фортран}&quot;. В первом случае сработал наш распознаватель 1 - тут проводился простой контекстный поиск, без учета регистра букв. Подведем к этому слову курсор и раскроем меню &quot;Действия смарт-тегов&quot; (рис. 5). Как видно, меню сформировано в соответствии с нашим кодом (см. заголовок и первые три команды). Обратите внимание на новую команду меню, которой в предыдущих примерах не было, - &quot;Проверка новых действий...&quot;. Это встроенная команда, которая автоматически ссылается на Web-ресурс, прописанный в свойстве ISmartTagRecognizer_SmartTagDownloadURL (строка появляется в меню, если этот адрес определен). Выберите разные команды меню и убедитесь, что вызываемый Internet Explorer обращается по заданным адресам.
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict5.gif" alt=Fig.5></td></tr>
<tr><td valign="bottom">Рис. 5. Сформированное нами меню для обработки смарт-тега.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<p>Теперь подведем курсор ко второму найденному смарт-тегу &quot;{Фортран}&quot; и раскроем меню (рис. 6). Тут видно, что на него, как и было задумано, среагировали оба созданных нами распознавателя (если курсор установить точно на фигурную скобку, то будет работать только второй распознаватель). Выберем второй вариант обработки, а далее команду &quot;Выдача сообщения&quot;. Посмотрим на содержимое параметров, передаваемых в метод InvokeVerb и представленных в окне сообщений (рис. 7).
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict6.gif" alt=Fig.6></td></tr>
<tr><td valign="bottom">Рис. 6. Этот фрагмент соответствует двум разным смарт-тегам.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict7.gif" alt=Fig.7></td></tr>
<tr><td valign="bottom">Рис. 7. Содержимое параметров, передаваемых в метод InvokeVerb.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<p>В результате проведенного тестирования прояснились некоторые детали работы технологии. Так, можно высказать некоторые предположения относительно назначения свойств SmartTagCount и SmartTagName в интерфейсах Recognizer и Action. Судя по всему, офисное приложение при загрузке сначала опрашивает все обнаруженные им обработчики и формирует таблицу соответствия между типами смарт-тегов и обработчиками. Это делается именно с помощью чтения свойств SmartTagCount и SmartTagName. Поэтому, например, если в нашем программном коде установить константу SmartTagCountX = 1, то в методе Recognize не будет выполняться установка смарт-тегов для второго варианта, так как соответствующее имя типа не было прописано в этой таблице.
<h3>О нюансах регистрации DLL-обработчиков </h3>
<p>В завершение этого обзора отметим еще один важный нюанс, касающийся управления обработчиками смарт-тегов. Как мы уже говорили, в списке &quot;Распознаватели&quot; окна &quot;Сервис | Автозамена | Смарт-теги&quot; можно указывать обработчики, действующие для данного приложения (рис. 4). Проведем эксперимент - откроем это окно и сбросим флажки у всех распознавателей. После этого перезагрузим Word 2002 и опять посмотрим на содержимое данного диалогового окна (рис. 8) - теперь все флажки сброшены, а последний установлен! Почему это происходит?
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict8.gif" alt=Fig.8></td></tr>
<tr><td valign="bottom">Рис. 8. Для нашего смарт-тега флажок почему-то установлен.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<p>Чтобы ответить на этот вопрос, откроем в системном Реестре папку HKEY_CURRENT_USER\Software\Microsoft\Office\Common\Smart Tag (рис. 3). Обратите внимание, что наша библиотека DLL зарегистрирована с помощью некоего вполне осмысленного идентификатора, а остальные ключи (это обработчики, поставляемые в составе Office XP) - с использованием замысловатого шестнадцатеричного кода. (Кстати, на рисунке хорошо видно, что число классов Actions не совпадает с числом Recognizers. Дело в том, что необязательно совмещать несколько распознавателей или обработчиков в один класс, их можно смело разделить между разными модулями. Ведь их соответствие определяется по уникальным именам SmartTagName.)
<p>Различие это объясняется тем, что для созданного обработчика мы использовали его внутренний идентификатор ProgID, а для других применен CLSID - уникальный идентификатор класса, который был присвоен модулю в момент его регистрации на данном компьютере в качестве ActiveX-сервера. Механизм Smart Tags не поддерживает сохранение статуса &quot;подключен/отключен&quot; для DLL, зарегистрированных с помощью ProgID. Если вы хотите, чтобы ваши установки сохранялись, их нужно регистрировать с помощью CLSID.
<p>Это делается следующим образом. Найдите в разделе HKEY_CLASSES_ROOT системного Реестра папку с именем нужного класса, в данном случае AndySimpleTest.SmartTagAction\Clsid. В правой части окна выделите правой кнопкой мыши строку Default, а затем выберите команду Modify в появившемся контекстном меню. В открывшемся диалоговом окне щелкните правой кнопкой мыши поле Value data, а затем команду Copy (рис. 9). Далее откройте папку HKEY_CURRENT_USER\Software\Microsoft\Office\Common\Smart Tag\Actions и замените в нем ключ со значением AndySimpleTest.SmartTagAction на содержимое буфера обмена (если вы регистрируете обработчик первый раз, то создайте новый ключ). Далее такую же операцию выполните для распознавателя AndySimpleTest.SmartTagRecognizer.
<p>
<table width="100%" border="0">
<tr><td><img src="http://www.bytemag.ru/images/byte_archive/images/No11/smarttag2/pict9.gif" alt=Fig.9></td></tr>
<tr><td valign="bottom">Рис. 9. Копируем уникальный идентификатор класса CLSID.
<hr noshade align="left" size="0">
</td></tr>
</table>
<p>
<p>Однако при использовании CLSID нужно иметь в виду, что в случае повторной регистрации ActiveX-сервера для него будет выделяться новый уникальный идентификатор, т. е. значение, записанное в раздел Smart Tag, утратит силу, его нужно будет корректировать заново. Отсюда совет - на этапе отладки DLL используйте регистрацию с помощь ProgID (как это мы и делали) и лишь после получения окончательного варианта замените код на CLSID.
<h3>Это еще не окончание... </h3>
<p>Можно считать, что мы разобрались с созданием DLL-обработчиков, по крайней мере с основными возможностями этой технологии. Конечно, многие нюансы не были рассмотрены, тут есть еще что изучать. Подводя промежуточный итог тестирования, хотелось бы отметить, что процедуры регистрации обработчиков (и XML, и DLL) кажутся пока довольно запутанными и работают не очень надежно. Например, заметны проблемы с подключением XML-обработчиков (похоже, это каким-то образом связано с проверкой грамматики). Мои эксперименты с регистрацией DLL показали, что тут тоже используется довольно хрупкий механизм...
<p>И все же теперь пора попытаться ответить на главный вопрос - для каких реальных практических задач можно применить технологию Smart Tags? Этим мы и займемся в следующий раз.
<p>


<table width="100%" border="0" bgcolor="#66FFCC" >
  <tr>
    <th>Листинг 4. Выполнение операций по обработке смарт-тегов</th>
  </tr>
  <tr>
    <td><pre>Private Sub ISmartTagAction_InvokeVerb _
  (ByVal VerbID As Long, _
   ByVal ApplicationName As String, _
   ByVal Target As Object, _
   ByVal Properties As _
     SmartTagLib.ISmartTagProperties, _
   ByVal Text As String, _
   ByVal Xml As String)
   
  &#39;Выполнение каких-то действий 
  &#39; при выборе команды меню
 
  &#39; Для выбора конкретной операции
  &#39; можно использовать анализ
  &#39; всех входных параметров, но мы 
  &#39; сейчас используем только VerbID
  If VerbID &lt;= 3 Then  
   &#39; обращение к Internet Explorer
   Dim ieObject As Object
   Set ieObject = CreateObject _
    (&quot;InternetExplorer.Application&quot;)
   With ieObject
     Select Case VerbID
      Case 1
        .Navigate2 &quot;www.microsoft.com&quot;
      Case 2
        .Navigate2 &quot;www.pcweek.ru&quot;
      Case 3
        .Navigate2 &quot;www.bytemag.ru&quot;
     End Select
    .Visible = True
   End With
  Else   &#39; вывод такого сообщения
    MsgBox &quot;ApplicationName = &quot; _
     & ApplicationName & vbCrLf & _
     &quot;Число свойств смарт-тега = &quot; & _
     Properties.Count & vbCrLf & _
     &quot;Text = &quot; & Text & vbCrLf & _
     &quot;XML = &quot; & Xml
  End If
End Sub</pre></td>
  </tr>
</table>

</DIV><TABLE cellpadding='0' cellspacing='0' border='0' width='100%'><TR valign='top'><TD width='48%'><DIV class='tit-grey'><h4>Другие статьи из раздела</h4></DIV><ul class='list-links'><li><b><A href='detail.php@ID=16073.html'>Intel Parallel Composer – отладка параллельных программ</A></b></li><li><b><A href='detail.php@ID=15724.html'>Intel Parallel Inspector – поиск ошибок многопоточности</A></b></li><li><b><A href='detail.php@ID=15064.html'>Intel Parallel Amplifier – профилировщих многопоточных приложений</A></b></li><li><b><A href='detail.php@ID=14909.html'>Intel Parallel Inspector – поиск ошибок доступа к памяти</A></b></li><li><b><A href='detail.php@ID=14743.html'>Intel Parallel Studio – инструмент для создания параллельных приложений</A></b></li></ul></TD><TD width='4%'>&nbsp;</TD><TD width='48%'></TD></TR></TABLE><br /><noindex><table border='0' cellpadding='0' cellspacing='0' width='100%'><tr valign='top'><td width='5' class='title-b'><img src='../images/byte/title-b.gif'></td><td width='2'><img src='../images/byte/title-l.gif'></td><td class='bg-title-2' valign='middle' nowrap><a name='add-blog'></a>Поместить в блог</td><td width='2'><img src='../images/byte/title-r.gif'></td><td width='90%' class='title-b'><img src='../images/byte/title-b.gif'></td></tr></table><br /><FORM name='FormBlog'><textarea name='MsgCode' style='width:100%; height:100px; font-size: 11px;'><table border="0" width="75%" style="margin:10px; border:2px solid #000; background-color:#FFF;"><tr><td align="right"><a href="../index.html" target="_blank"><img src="../images/byte/logo-blog.gif" style="width:71px; height:40px; border:0;" alt="BYTE/Россия"></a></td></tr><tr><td><a href="detail.php@ID=8884.html" target="_blank" style="font:14px Arial; color:#000; text-decoration:none; font-weight:bold;">Разработка Smart Tags в виде ActiveX DLL
</a><br><a href="detail.php@ID=8884.html" target="_blank" style="font:12px Arial; color:#000; text-decoration:none;">Андрей Колесов
Для чтения этой статьи желательны некоторые познания в разработке COM-объектов 
  и языке Visual Basic. Полный вариант&nbsp&hellip;</a></td></tr><tr><td align="right"><a href="detail.php@ID=8884.html" target="_blank" style="font:12px Arial;">Открыть материал</a></td></tr></table></textarea><DIV class='btn-grey'><input type='button' value='Скопировать код' class='200px' OnClick='javascript: BlogCopyClipboard(this.form.MsgCode);'><input type='button' value='Предпросмотр' class='200px' OnClick='javascript: BlogPreview();'></DIV></FORM></noindex><table border='0' cellpadding='0' cellspacing='0' width='100%'><tr valign='top'><td width='5' class='title-b'><img src='../images/byte/title-b.gif'></td><td width='2'><img src='../images/byte/title-l.gif'></td><td class='bg-title-2' valign='middle' nowrap><a name='add-comment'></a>Комментарии к статье</td><td width='2'><img src='../images/byte/title-r.gif'></td><td width='90%' class='title-b'><img src='../images/byte/title-b.gif'></td></tr></table><br /><p><form name='AddComment' action='http://www.bytemag.ru/articles/detail.php?ID=8884&amp;' method='post'><b>Ваше имя</b><span class='rs'>*</span><br /><input type='text' name='AUTHOR_NAME' value='' size='20' class='100p'><br /><br /><b>Ваш комментарий</b><span class='rs'>*</span><br /><textarea name='COMMENT' cols='70' rows='10' class='100p'></textarea><br /><br /><b>Защита от автоматических сообщений</b><span class='rs'>*</span><br /><br /><input type='hidden' name='captcha_code' value='0d6e228a56bf73418228bc3620217655'><img src='../bitrix/tools/captcha.php@captcha_code=0d6e228a56bf73418228bc3620217655' class='captcha' /><br /><br />Введите символы на картинке <input type='text' size='20' name='captcha_word' value='' class='100p'><DIV class='btn-grey'><input type='submit' name='SUBMIT' value='Добавить комментарий' class='200px'></DIV><span class='rs'>*</span> - Поля, обязательные для заполнения.</form></p>
<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='1%' valign='top'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></td><td width='99%' class='bg-title'><span>Рекламные ссылки</span></td></tr></table><DIV class='block-g'><div style='margin-bottom:5px;'><b><a href='../about/index.html' target='_blank'>BYTEmag.ru приглашает к сотрудничеству авторов статей  по корпоративной ИТ-тематике. </a></b></div><div style='margin-bottom:5px;'><b><a href='index.php@TYPE_ID=16029.html' target='_blank'>Коммутаторы начального уровня</a></b></div><div style='margin-bottom:5px;'><b><a href='index.php@TYPE_ID=6258.html' target='_blank'>В рубрике &quot;Безопасность&quot; появилась новая статья о выборе антивирусов</a></b></div><div style='margin-bottom:5px;'><b><a href='http://itrp.ru/41/' target='_blank'>ITRN — современные информационные технологии</a></b></div></DIV>


	<table cellspacing='0' cellpadding='0' border='0' width='100%'>
	<tr valign='top'><td width='50%'>
	<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../foto/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../foto/index.html'>Фоторепортажи</a></td></tr></table><DIV class='block-g'><a href='../foto/detail.php@ID=19983.html'><IMG src='../upload/iblock/4d5/1.jpg' alt='Демонстрация Chloride Trinergy' class='tn-foto'></a><b>Chloride</b><br /><b><a href='../foto/detail.php@ID=19983.html'>Демонстрация Chloride Trinergy</a></b><br />Впервые в России компания Chloride Rus провела демонстрацию системы бесперебойного электропитания Chloride Trinergy®, а также ИБП Chloride 80-NET™, NXC и NX для своих партнеров и заказчиков.<br /><br /><a href='../foto/detail.php@ID=17939.html'><IMG src='../upload/iblock/b04/IMG_7608.jpg' alt='Завершена реорганизация двух дочерних предприятий NEC Corporation в России' class='tn-foto'></a><b>NEC Нева Коммуникационные Системы</b><br /><b><a href='../foto/detail.php@ID=17939.html'>Завершена реорганизация двух дочерних предприятий NEC Corporation в России</a></b><br />С 1 декабря 2010 года Генеральным директором ЗАО «NEC Нева Коммуникационные Системы» назначен Раймонд Армес, занимавший ранее пост Президента Shyam …<br /><br /><a href='../foto/detail.php@ID=17921.html'><IMG src='../upload/iblock/2b0/1.JPG' alt='С 17 по 19 ноября 2010 в Москве, в КВЦ «Сокольники», состоялась VII Международная выставка InfoSecurity Russia. StorageExpo. Documation’2010.' class='tn-foto'></a><b>компания «Гротек»</b><br /><b><a href='../foto/detail.php@ID=17921.html'>С 17 по 19 ноября 2010 в Москве, в КВЦ «Сокольники», состоялась VII Международная выставка InfoSecurity Russia. StorageExpo. Documation’2010.</a></b><br />Новейшие решения защиты информации, хранения данных и документооборота и защиты персональных данных представили 104 организации. 4 019 руководителей …<br /><br /><a href='../foto/index.html' class='link'>Другие фоторепортажи</a></DIV>	</td>
	<td><img src="../images/byte/pix.gif" width="10" height="1" border="0"></td>
	<td width='50%'>
	<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../video/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../video/index.html'>Видеоролики</a></td></tr></table><DIV class='block-g'><a href='../video/detail.php@ID=17721.html'><img src='../upload/iblock/ae3/adaptec.jpg' alt='RAID-контроллеры Adaptec Series 5Z с безбатарейной защитой кэша' class='tn-video'></a><b>Adaptec by PMC</b><br /><b><a href='../video/detail.php@ID=17721.html'>RAID-контроллеры Adaptec Series 5Z с безбатарейной защитой кэша</a></b><br />Опытные сетевые администраторы знают, что задействование в работе кэш-памяти RAID-контроллера дает серьезные преимущества в производительности …<br /><br /><a href='../video/detail.php@ID=16525.html'><img src='../upload/iblock/c6e/v1.jpg' alt='Трехфазный ИБП Chloride от 200 до 1200 кВт: Trinergy' class='tn-video'></a><b>Chloride</b><br /><b><a href='../video/detail.php@ID=16525.html'>Трехфазный ИБП Chloride от 200 до 1200 кВт: Trinergy</a></b><br />Trinergy — новое решение на рынке ИБП, впервые с динамическим режимом работы, масштабируемостью до 9.6 МВт и КПД до 99%. Уникальное сочетание …<br /><br /><a href='../video/detail.php@ID=15824.html'><img src='../upload/iblock/134/delphi.jpg' alt='Возможности Delphi 2010' class='tn-video'></a><b>Embarcadero</b><br /><b><a href='../video/detail.php@ID=15824.html'>Возможности Delphi 2010</a></b><br />Посмотрите обзор среды разработки Delphi и оцените, как можно использовать данную технологию для быстрой разработки Windows-приложений. В это обзоре …<br /><br /><a href='../video/index.html' class='link'>Другие видеоролики</a></DIV>	</td></tr>
	</table>

</TD>
<TD width='10'><img src="../images/byte/pix.gif" width="10" height="1" border="0"></TD>
<TD width='160'>


<DIV class='adv'><script language="JavaScript">
<!--
var banner_random = Math.round(Math.random() * 100000);
document.write('<iframe name="byte_right_adv" id="byte_right_adv" src="/ad/banners/right.php?banner_random='+banner_random+'" width="100%" height="600" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>');
// -->
</script>
<noscript>
<iframe name="byte_right_adv" id="byte_right_adv" src="../ad/banners/right.php.html" width="100%" height="600" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>
</noscript>
</DIV>
<DIV class='block-g'>Опубликован обзор по теме <font color="#0000FF"><b><a href="../bitrix/rk.php@id=375&amp;event1=banner&amp;event2=click&amp;event3=1+%252F+[375]+[TXT2]+Коммутаторы+начального+уровня+апрель+2014&amp;goto=http%253A%252F%252Fwww.bytemag.ru%252Farticles%252Fdetail.php%253FID=25176.html" target="_blank" >&laquo;Коммутаторы начального уровня&raquo;</a></b></font>. Рынок коммутаторов для сети передачи данных показывает востребованность этих устройств: согласно отчёту IDC в III квартале прошлого года на мировом рынке коммутаторов Ethernet рост составил 6,5%, а объём рынка достиг 5,66 млрд долл. 
<br />

<br />
 </DIV>
<DIV class='adv'>
</DIV>
<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../themes/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../themes/index.html'>Темы</a></td></tr></table><DIV class='block-g'><ul class='list-links'><li><a href='index.php@THEME_ID=6261.html'>Перспективные технологии</a><li><a href='index.php@THEME_ID=6262.html'>Информационная безопасность</a><li><a href='index.php@THEME_ID=6263.html'>Серверы</a><li><a href='index.php@THEME_ID=6264.html'>HPC (High Performance Computing)</a><li><a href='index.php@THEME_ID=6265.html'>Центры обработки данных</a><li><a href='index.php@THEME_ID=6266.html'>Технологии хранения данных</a><li><a href='index.php@THEME_ID=6267.html'>Инфраструктурные технологии</a><li><a href='index.php@THEME_ID=6268.html'>Периферийное оборудование</a><li><a href='index.php@THEME_ID=6269.html'>Телеком-решения</a><li><a href='index.php@THEME_ID=6270.html'>Мобильные решения</a><li><a href='index.php@THEME_ID=6271.html'>ERP</a><li><a href='index.php@THEME_ID=6272.html'>Документооборот</a><li><a href='index.php@THEME_ID=6273.html'>Управление бизнес-процессами</a><li><a href='index.php@THEME_ID=6274.html'>Бизнес-аналитика</a><li><a href='index.php@THEME_ID=6275.html'>Интеграционные технологии</a><li><a href='index.php@THEME_ID=6276.html'>Разработка приложений</a><li><a href='index.php@THEME_ID=12163.html'>Интеграция данных и приложений</a><li><a href='index.php@THEME_ID=12781.html'>Управление ИТ-инфраструктурой</a><li><a href='index.php@THEME_ID=11766.html'>Технологии виртуализации</a></ul></DIV>
<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../events/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../events/index.html'>Мероприятия</a></td></tr></table><DIV class='block-g'>22 апреля 2014 г.&nbsp;|&nbsp;Москва<br /><b><a href='../events/detail.php@ID=25002.html'>Dell Desktop Virtualization Forum 2014</a></b><br /><br />20 &#151; 22 мая 2014 г.&nbsp;|&nbsp;Новосибирск <br /><b><a href='../events/detail.php@ID=25217.html'>Межрегиональный  форум «Инфосибирь»</a></b><br /><br />20 мая 2014 г.&nbsp;|&nbsp;Москва<br /><b><a href='../events/detail.php@ID=25221.html'>Docflow 2014 </a></b><br /><br /><a href='../events/index.html' class='link'>Другие мероприятия</a></DIV>
<table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../forum/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../forum/index.html'>Форумы</a></td></tr></table><DIV class='block-g'><b><A href='../forum/forum2/topic70917/index.html'>EOS for SharePoint: ЕСМ и СЭД «в одном флаконе»</A></b><br />Федор Буцко, 07.04.2014 20:24:47<br /><br /><b><A href='../forum/forum2/topic70916/index.html'>Как построить собственный ЦОД</A></b><br />Александр, 01.04.2014 19:08:52<br /><br /><b><A href='../forum/forum2/topic70915/index.html'>Блейд-серверы HP в эволюции ИТ-инфраструктуры</A></b><br />Жания, 28.03.2014 12:12:38<br /><br /><b><A href='../forum/forum2/topic70914/index.html'>StarWind Native SAN для Hyper-V: история успеха</A></b><br />satosan, 24.03.2014 12:54:37<br /><br /><b><A href='../forum/forum2/topic70913/index.html'>Новые технологии в Security operation center</A></b><br />Иван, 20.03.2014 09:53:28<br /><br /></DIV><table border='0' cellpadding='0' cellspacing='0' width='100%'><tr><td width='5%' valign='top'><a href='../press/index.html'><img src='../images/byte/btn-arrow.gif' class='btn-arrow'></a></td><td width='95%' class='bg-title'><a href='../press/index.html'>Пресс-релизы</a></td></tr></table><DIV class='block-g'><b><a href='../press/detail.php@ID=25278.html'>ПСС приняла участие в Autodesk BIM Форуме</a></b><br /><br /><b><a href='../press/detail.php@ID=25277.html'>«Ландшафтдизайнпроект» повышает эффективность </a></b><br /><br /><b><a href='../press/detail.php@ID=25276.html'>Google и Citrix приступили к разработке новых реше</a></b><br /><br /><a href='../press/index.html'>Другие пресс-релизы</a></DIV></TD>
<TD width='5'><img src="../images/byte/pix.gif" width="5" height="1" border="0"></TD>
</TR>
<TR>
<TD colspan='7' class='bottom-banner'>

<script language="JavaScript">
<!--
var banner_random = Math.round(Math.random() * 100000);
document.write('<iframe name="byte_bottom_adv" id="byte_bottom_adv" src="/ad/banners/bottom.php?banner_random='+banner_random+'" width="100%" height="60" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>');
// -->
</script>
<noscript>
<iframe name="byte_bottom_adv" id="byte_bottom_adv" src="../ad/banners/bottom.php.html" width="100%" height="60" frameborder="0" scrolling="no" vspace="0" hspace="0" marginwidth="0" marginheight="0"></iframe>
</noscript>

</TD>
</TR>
<TR>
<TD colspan='7' class='bg-on-footer'><img src="../images/byte/bg-on-footer.gif"></TD>
</TR>
</TABLE>
<DIV class='copy'>

<div style="float:right;">
<script type="text/javascript">
<!--
Nnv=navigator;Nna=Nnv.appName;Nd=document;Nd.cookie="b=b";Nc=0;if(Nd.cookie)Nc=1;
Nn=(Nna.substring(0,2)=="Mi")?0:1;Ns=screen;Npx=(Nn==0)?Ns.colorDepth:Ns.pixelDepth;
str='<img src="http://c.cnstats.ru/755;'+Ns.width+'x'+Ns.height+';'+Npx+';'+Nc+';';
str=str+escape(Nd.referrer)+';'+Math.random()+'" width="88" height="31" border="0">';
document.write('<a href="http://www.cnstats.ru/" alt="CNStats Rating" target="_blank">'+str+'</a>');
// -->
</script>
<noscript><a href="http://www.cnstats.ru/" target="_blank"><img src="http://c.cnstats.ru/755;0x0;0;0;-;0" alt="CNStats Rating" width="88" height="31" border="0"></a></noscript> 
</div>

<a href="http://www.imake.ru"><img src="../images/imake/imake-logo.gif" width="88" height="31" border="0" alt="Студия iMake" style="float:right;"></a>

&copy; 2001—2014 ЗАО «СК Пресс». <a href="../credits/index.html">Информация об авторских правах и порядке использования материалов сайта</a><br />
109147 г. Москва, ул. Марксистская, 34, строение 10. Телефон: (495) 974–2260. Факс: (495) 974-2263. E-mail: <a href='mailto:byte@bytemag.ru'>byte@bytemag.ru</a>.


<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-2722156-6");
pageTracker._initData();
pageTracker._trackPageview();
</script>

<!-- Yandex.Metrika counter --><div style="display:none;"><script type="text/javascript">(function(w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter12877408 = new Ya.Metrika({id:12877408, enableAll: true, webvisor:true}); } catch(e) { } }); })(window, "yandex_metrika_callbacks");</script></div><script src="http://mc.yandex.ru/metrika/watch.js" type="text/javascript" defer="defer"></script><noscript><div><img src="http://mc.yandex.ru/watch/12877408" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->

</DIV>
<DIV class='sites'>
<a href='http://www.skpress.ru' target='_blank'>СК Пресс</a> | <a href='http://www.itbestsellers.ru' target='_blank'>Бестселлеры IT-рынка</a> | <a href='http://www.crn.ru' target='_blank'>CRN/RE</a>&nbsp;|&nbsp;<a href='http://www.pcmag.ru' target='_blank'>PC Magazine/RE</a>&nbsp;|&nbsp;<a href='http://www.pcweek.ru' target='_blank'>PC Week/RE</a>&nbsp;|&nbsp;<a href='http://www.iemag.ru' target='_blank'>Intelligent Enterprise/RE</a>
<script type="text/javascript">
var adf=$("#byte_left_adv img").css("height");
$("div.sites").append(adf);
</script>
</DIV>

</DIV>

</BODY>
</HTML>